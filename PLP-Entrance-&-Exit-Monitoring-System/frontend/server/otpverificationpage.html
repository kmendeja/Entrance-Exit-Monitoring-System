<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PLP Facial Monitor | OTP Verification</title>
<link rel="icon" href="../images/logosmallplp.png">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<style>
    *{
      margin:0;
      padding:0;
      box-sizing:border-box;
      font-family:'Poppins',sans-serif;
    }

    /* ===== BODY ===== */
    body{
      min-height:100vh;
      padding:20px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:
        linear-gradient(
          rgba(10, 123, 61, 0.75),
          rgba(37, 99, 45, 0.75),
          rgba(255, 222, 89, 0.75)
        ),
        url("../images/admin-loginpage.png") center/cover no-repeat;
    }

    /* ===== CARD ===== */
    .otp-box{
      width:100%;
      max-width:420px;
      background:#fff;
      padding:90px 28px 40px;
      border-radius:12px;
      text-align:center;
      box-shadow:0 12px 35px rgba(0,0,0,.25);
      position:relative;
    }

    /* ===== LOGO ===== */
    .logo{
      position:absolute;
      top:-55px;
      left:50%;
      transform:translateX(-50%);
      width:clamp(90px, 20vw, 110px);
      height:clamp(90px, 20vw, 110px);
      background:#fff;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:0 6px 20px rgba(0,0,0,.25);
    }
    .logo img{
      width:80%;
    }

    /* ===== HEADER ===== */
    .header{
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      margin-bottom:8px;
    }

    .back-btn{
      position:absolute;
      left:0;
      background:none;
      border:none;
      font-size:1.2rem;
      cursor:pointer;
      color:#0a7c3c;
    }
    .back-btn:hover{
      color:#096a33;
    }

    /* ===== TEXT ===== */
    h2{
      font-size:clamp(1.4rem, 4vw, 1.7rem);
      font-weight:700;
      margin-bottom:6px;
    }

    .subtitle{
      font-size:clamp(.85rem, 3vw, .95rem);
      color:#666;
      margin-bottom:12px;
      line-height:1.5;
    }

    /* ===== TIMER ===== */
    .timer{
      font-size:clamp(.8rem, 3vw, .9rem);
      color:#0a7c3c;
      font-weight:600;
      margin-bottom:24px;
    }
    .timer.expired{
      color:#b00020;
    }

    /* ===== OTP INPUTS ===== */
    .otp-inputs{
      display:flex;
      justify-content:center;
      gap:clamp(6px, 2vw, 12px);
      margin-bottom:28px;
    }

    .otp-inputs input{
      width:clamp(40px, 12vw, 52px);
      height:clamp(46px, 12vw, 56px);
      text-align:center;
      font-size:clamp(1.1rem, 3vw, 1.3rem);
      font-weight:600;
      border-radius:8px;
      border:2px solid #e0e0e0;
      background:#f1f1f1;
    }

    .otp-inputs input:focus{
      outline:none;
      border-color:#0a7c3c;
      background:#fff;
    }

    /* ===== BUTTON ===== */
    .next-btn{
      width:100%;
      padding:14px;
      border:none;
      background:#0a7c3c;
      color:#fff;
      font-weight:600;
      border-radius:4px;
      cursor:pointer;
      transition:.2s;
    }

    .next-btn:disabled{
      background:#ccc;
      cursor:not-allowed;
    }

    .next-btn:hover:not(:disabled){
      background:#096a33;
    }

    /* ===== RESEND ===== */
    .resend{
      margin-top:14px;
      font-size:.85rem;
    }

    .resend a{
      color:#0a7c3c;
      font-weight:600;
      text-decoration:none;
      cursor:pointer;
    }

    .resend a.disabled{
      color:#999;
      pointer-events:none;
    }

    .resend a:hover{
      text-decoration:underline;
    }

    /* ===== MOBILE ===== */
    @media(max-width:480px){
      .otp-box{
        padding:80px 20px 32px;
      }

      .back-btn{
        font-size:1.1rem;
      }

      .next-btn{
        font-size:.95rem;
      }
    }
</style>
</head>

<body>

<div class="otp-box">
    <div class="logo">
      <img src="../images/logo.png" alt="PLP Logo">
    </div>

    <div class="header">
      <button class="back-btn" onclick="window.location.href='forgotpasswordpage.html'">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2>OTP Verification</h2>
    </div>

    <p class="subtitle">
      Your verification code has been sent to your email address.
    </p>

    <div class="timer" id="timer">
      Code expires in <span id="time">05:00</span>
    </div>

    <form id="otpForm">
      <div class="otp-inputs">
        <input type="text" class="otp" maxlength="1" inputmode="numeric" pattern="[0-9]*">
        <input type="text" class="otp" maxlength="1" inputmode="numeric" pattern="[0-9]*">
        <input type="text" class="otp" maxlength="1" inputmode="numeric" pattern="[0-9]*">
        <input type="text" class="otp" maxlength="1" inputmode="numeric" pattern="[0-9]*">
        <input type="text" class="otp" maxlength="1" inputmode="numeric" pattern="[0-9]*">
        <input type="text" class="otp" maxlength="1" inputmode="numeric" pattern="[0-9]*">
      </div>

      <button type="submit" class="next-btn" id="submitBtn">Next</button>
    </form>

    <div class="resend">
      Didnâ€™t receive the code?
      <a id="resendOtp" class="disabled">Resend OTP</a>
    </div>
    </div>

<script>
$(document).ready(function(){

  /* ===== OTP INPUT LOGIC ===== */
  $(".otp").on("input", function(){
    this.value = this.value.replace(/[^0-9]/g, "");
    if(this.value.length === 1){
      $(this).next(".otp").focus();
    }
  });

  $(".otp").on("keydown", function(e){
    if(e.key === "Backspace" && this.value === ""){
      $(this).prev(".otp").focus();
    }
  });

  $(".otp").on("paste", function(e){
    e.preventDefault();
  });

  /* ===== TIMER ===== */
  let countdown;
  let timeLeft = 300;

  const timerBox = $("#timer");
  const submitBtn = $("#submitBtn");
  const resendLink = $("#resendOtp");

  function startTimer(){
    timeLeft = 300;
    resendLink.addClass("disabled");
    submitBtn.prop("disabled", false);

    timerBox
      .removeClass("expired")
      .html('Code expires in <span id="time">05:00</span>');

    countdown = setInterval(function(){
      let minutes = Math.floor(timeLeft / 60);
      let seconds = timeLeft % 60;

      $("#time").text(
        `${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`
      );

      if(timeLeft <= 0){
        clearInterval(countdown);
        timerBox
          .addClass("expired")
          .text("OTP has expired. Please request a new code.");
        submitBtn.prop("disabled", true);
        resendLink.removeClass("disabled");
      }

      timeLeft--;
    }, 1000);
  }

  startTimer();

  /* ===== RESEND OTP ===== */
  resendLink.on("click", function(){
    if($(this).hasClass("disabled")) return;

    $(".otp").val("");
    $(".otp").first().focus();

    // BACKEND CALL HERE
    // $.post("resend-otp.php");

    startTimer();
  });

  /* ===== SUBMIT ===== */
  $("#otpForm").on("submit", function(e){
    let complete = true;

    $(".otp").each(function(){
      if($(this).val() === ""){
        complete = false;
      }
    });

    if(!complete){
      e.preventDefault();
      alert("Please enter the complete 6-digit OTP.");
    }
  });

});
</script>

</body>
</html>

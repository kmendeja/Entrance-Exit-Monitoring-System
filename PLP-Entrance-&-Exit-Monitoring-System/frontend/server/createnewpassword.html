<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PLP Facial Monitor | New Password</title>
<link rel="icon" href="../images/logosmallplp.png">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<style>
              *{
                margin:0;
                padding:0;
                box-sizing:border-box;
                font-family:'Poppins',sans-serif;
              }

              /* ===== BODY ===== */
              body{
                min-height:100vh;
                padding:20px;
                display:flex;
                align-items:center;
                justify-content:center;
                background:
                  linear-gradient(
                    rgba(10, 123, 61, 0.75),
                    rgba(37, 99, 45, 0.75),
                    rgba(255, 222, 89, 0.75)
                  ),
                  url("../images/admin-loginpage.png") center/cover no-repeat;
              }

              /* ===== CARD ===== */
              .password-box{
                width:100%;
                max-width:420px;
                background:#fff;
                padding:90px 28px 40px;
                border-radius:12px;
                text-align:center;
                box-shadow:0 12px 35px rgba(0,0,0,.25);
                position:relative;
              }

              /* ===== LOGO ===== */
              .logo{
                position:absolute;
                top:-55px;
                left:50%;
                transform:translateX(-50%);
                width:clamp(90px, 20vw, 110px);
                height:clamp(90px, 20vw, 110px);
                background:#fff;
                border-radius:50%;
                display:flex;
                align-items:center;
                justify-content:center;
                box-shadow:0 6px 20px rgba(0,0,0,.25);
              }
              .logo img{
                width:80%;
              }

              /* ===== HEADER ===== */
              .header{
                display:flex;
                align-items:center;
                justify-content:center;
                position:relative;
                margin-bottom:8px;
              }

              .back-btn{
                position:absolute;
                left:0;
                background:none;
                border:none;
                font-size:1.2rem;
                cursor:pointer;
                color:#0a7c3c;
              }
              .back-btn:hover{
                color:#096a33;
              }

              /* ===== TEXT ===== */
              h2{
                font-size:clamp(1.4rem, 4vw, 1.7rem);
                font-weight:700;
                margin-bottom:6px;
              }

              .subtitle{
                font-size:clamp(.85rem, 3vw, .95rem);
                color:#666;
                margin-bottom:24px;
                line-height:1.5;
              }

              /* ===== FORM GROUPS ===== */
              .form-group{
                text-align: left;
                margin-bottom: 20px;
                position: relative;
              }

              .form-group label{
                display: block;
                font-size: 0.85rem;
                font-weight: 600;
                margin-bottom: 6px;
                color: #333;
              }

              .input-wrapper {
                position: relative;
              }

              .form-group input{
                width: 100%;
                padding: 12px 40px 12px 14px;
                border: 2px solid #e0e0e0;
                border-radius: 8px;
                font-size: 0.95rem;
                transition: 0.3s;
                background: #f9f9f9;
              }

              .form-group input:focus{
                outline: none;
                border-color: #0a7c3c;
                background: #fff;
              }

              .toggle-password {
                position: absolute;
                right: 14px;
                top: 50%;
                transform: translateY(-50%);
                cursor: pointer;
                color: #999;
                transition: 0.2s;
              }

              .toggle-password:hover {
                color: #0a7c3c;
              }

              /* ===== REQUIREMENTS ===== */
              .requirements {
                text-align: left;
                margin-bottom: 24px;
                background: #f4fcf7;
                padding: 12px;
                border-radius: 8px;
              }

              .requirement-item {
                font-size: 0.75rem;
                color: #666;
                display: flex;
                align-items: center;
                gap: 8px;
                margin-bottom: 4px;
              }

              .requirement-item i {
                font-size: 0.7rem;
              }

              .requirement-item.valid {
                color: #0a7c3c;
              }

              .requirement-item.valid i {
                color: #0a7c3c;
              }

              /* ===== BUTTON ===== */
              .reset-btn{
                width:100%;
                padding:14px;
                border:none;
                background:#0a7c3c;
                color:#fff;
                font-weight:600;
                border-radius:8px;
                cursor:pointer;
                transition:.2s;
                font-size: 1rem;
              }

              .reset-btn:disabled{
                background:#ccc;
                cursor:not-allowed;
              }

              .reset-btn:hover:not(:disabled){
                background:#096a33;
                box-shadow: 0 4px 12px rgba(10, 124, 60, 0.2);
              }

              /* ===== MESSAGE BOX ===== */
              #msgBox {
                display: none;
                margin-top: 15px;
                padding: 10px;
                border-radius: 6px;
                font-size: 0.85rem;
              }

              .error-msg { background: #fde8e8; color: #c81e1e; }
              .success-msg { background: #def7ec; color: #03543f; }

              /* ===== MOBILE ===== */
              @media(max-width:480px){
                .password-box{
                  padding:80px 20px 32px;
                }
              }
              </style>
              </head>

<body>

        <div class="password-box">
          <div class="logo">
            <img src="../images/logo.png" alt="PLP Logo">
          </div>

          <div class="header">
            <button class="back-btn" onclick="window.history.back()">
              <i class="fas fa-arrow-left"></i>
            </button>
            <h2>New Password</h2>
          </div>

          <p class="subtitle">
            Create a strong password to protect your account.
          </p>

          <form id="passwordForm">
            <div class="form-group">
              <label for="newPassword">New Password</label>
              <div class="input-wrapper">
                <input type="password" id="newPassword" placeholder="Enter new password" required>
                <i class="fa-solid fa-eye-slash toggle-password"></i>
              </div>
            </div>

            <div class="form-group">
              <label for="confirmPassword">Confirm Password</label>
              <div class="input-wrapper">
                <input type="password" id="confirmPassword" placeholder="Confirm your password" required>
                <i class="fa-solid fa-eye-slash toggle-password"></i>
              </div>
            </div>

            <div class="requirements">
              <div class="requirement-item" id="req-length">
                <i class="fas fa-circle"></i> At least 8 characters
              </div>
              <div class="requirement-item" id="req-match">
                <i class="fas fa-circle"></i> Passwords must match
              </div>
            </div>

            <button type="submit" class="reset-btn" id="submitBtn">Update Password</button>
            <div id="msgBox"></div>
          </form>
        </div>

<script>
$(document).ready(function(){

  const STATIC_EMAIL = "admin@plpasig.edu.ph";

  // ===== INITIALIZE ACCOUNT IF NOT EXIST =====
  if(!localStorage.getItem("plpAccount")){
      const defaultAccount = {
          email: STATIC_EMAIL,
          password: "Admin123"
      };
      localStorage.setItem("plpAccount", JSON.stringify(defaultAccount));
  }

  /* ===== TOGGLE PASSWORD VISIBILITY ===== */
  $(".toggle-password").on("click", function(){
      const input = $(this).siblings("input");
      const isPassword = input.attr("type") === "password";

      input.attr("type", isPassword ? "text" : "password");
      $(this).toggleClass("fa-eye fa-eye-slash");
  });

  /* ===== VALIDATION LOGIC ===== */
  function validatePasswords() {
      const pass = $("#newPassword").val();
      const confirm = $("#confirmPassword").val();
      let isValid = true;

      if (pass.length >= 8) {
          $("#req-length").addClass("valid")
              .find("i").removeClass("fa-circle")
              .addClass("fa-check-circle");
      } else {
          $("#req-length").removeClass("valid")
              .find("i").addClass("fa-circle")
              .removeClass("fa-check-circle");
          isValid = false;
      }

      if (confirm !== "" && pass === confirm) {
          $("#req-match").addClass("valid")
              .find("i").removeClass("fa-circle")
              .addClass("fa-check-circle");
      } else {
          $("#req-match").removeClass("valid")
              .find("i").addClass("fa-circle")
              .removeClass("fa-check-circle");
          isValid = false;
      }

      return isValid;
  }

  $("#newPassword, #confirmPassword").on("input", function(){
      validatePasswords();
  });

  /* ===== SUBMIT ===== */
  $("#passwordForm").on("submit", function(e){
      e.preventDefault();

      const msgBox = $("#msgBox");

      if(validatePasswords()){

          $("#submitBtn").prop("disabled", true).text("Updating...");

          setTimeout(() => {

              // GET ACCOUNT
              const account = JSON.parse(localStorage.getItem("plpAccount"));

              // UPDATE PASSWORD
              account.password = $("#newPassword").val();

              // SAVE BACK
              localStorage.setItem("plpAccount", JSON.stringify(account));

              msgBox.removeClass("error-msg")
                    .addClass("success-msg")
                    .text("Password successfully updated!")
                    .fadeIn();

              setTimeout(() => {
                  window.location.href = "loginpage.html";
              }, 1500);

          }, 1000);

      } else {
          msgBox.removeClass("success-msg")
                .addClass("error-msg")
                .text("Please ensure all requirements are met.")
                .fadeIn();
      }
  });

});

</script>

</body>
</html> 